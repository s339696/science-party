@import models.ebean.User
@(title: String, user: User)(content: Html)

<!DOCTYPE html>

<html lang="de">
    <head>
        <title>@title</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.versioned("stylesheets/main.css")">
        <link rel="shortcut icon" type="image/png" href="@routes.Assets.versioned("images/favicon.png")">
        <script src="@routes.Assets.versioned("javascripts/jquery-2.1.4.js")" type="text/javascript"></script>
    </head>
    <body>
        <div class="Navigator">
            <ul class="Navigator">
                <li class="Navigator"><a class="Navigator" href="/profile">Profil</a></li>
                <li class="Navigator"><a class="Navigator" href="/friends">Freunde</a></li>
                <li class="Navigator"><a class="Navigator" href="/games">Spielen</a></li>
                <li class="Navigator"><a class="Navigator" href="/ranking">Ranking</a></li>
                <li class="Navigator"><a class="Navigator" href="/notifications/public">News</a></li>
                <ul class="topLoginSignin">
                    @if(user.getUnseenNotificationsCount != 0) {
                        <li class="topLoginSignin"><a id="notifications" class="topLoginSignin" href="/notifications/private">
                            Benachrichtigungen (@user.getUnseenNotificationsCount)</a></li>
                    } else {
                        <li class="topLoginSignin"><a id="notifications" class="topLoginSignin" href="/notifications/private">
                            Benachrichtigungen</a></li>
                    }
                    @if(user.getUnseenMessageCount != 0) {
                        <li class="topLoginSignin"><a id="messages" class="topLoginSignin" href="/messages">
                            Messages (@user.getUnseenMessageCount)</a></li>
                    } else {
                        <li class="topLoginSignin"><a id="messages" class="topLoginSignin" href="/messages">
                            Messages</a></li>
                    }
                <li class="topLoginSignin"><a id="logout" class="topLoginSignin" href="/logout">Logout</a></li>
                </ul>
            </ul>
        </div>
        <script>
                    // Initial and auto refresh of navigation bar
                    window.onload = (function() {
                        updateNavigator();
                    });

                    window.setInterval(function(){
                        updateNavigator();
                    }, 5000);


                    function updateNavigator() {
                        $.ajax({
                            url: '/notifications/private/count',
                            method: 'GET',
                            dataType: "text",
                            success: function(data,status,xhr) {
                                count = xhr.responseText;
                                if (count === "0") {
                                    $("#notifications").text("Benachrichtigungen");
                                } else {
                                    $("#notifications").text("Benachrichtigungen (" + xhr.responseText + ")");
                                }
                            },
                            error: function(xhr,status,error) {
                            }
                        });

                        $.ajax({
                            url: '/messages/new/count',
                            method: 'GET',
                            dataType: "text",
                            success: function(data,status,xhr) {
                                count = xhr.responseText;
                                if (count === "0") {
                                    $("#messages").text("Messages");
                                } else {
                                    $("#messages").text("Messages (" + xhr.responseText + ")");
                                }
                            },
                            error: function(xhr,status,error) {
                            }
                        });
                    }
            </script>
        @content
    </body>
</html>